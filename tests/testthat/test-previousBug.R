### test-previousBug.R --- 
##----------------------------------------------------------------------
## Author: Brice Ozenne
## Created: nov 19 2019 (10:17) 
## Version: 
## Last-Updated: nov 19 2019 (18:42) 
##           By: Brice Ozenne
##     Update #: 4
##----------------------------------------------------------------------
## 
### Commentary: 
## 
### Change Log:
##----------------------------------------------------------------------
## 
### Code:


## * Brice, 11/19/19 10:18, summary2 (name coef)
long <- data.frame("id" = c("1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"), 
                   "visit" = c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4), 
                   "weight" = c(127.2, 165.2, 109.7, 146.2, 113.1, 158.8, 115.4, 123.8, 105.8, 118.0, 137.7, 129.0, 117.4, 118.0, 115.0, 131.2, 122.4, 151.6, 173.0, 100.9, 120.7, 153.4, 101.6, 142.4, 105.6, 143.6, 108.8, 115.1, 102.0, 105.3, 131.9, 120.7, 108.5, 113.4, 109.7, 127.3, 113.9, 143.0, 162.2,  95.7, 115.5, 149.2,  97.7, 136.7,  99.9, 134.6, 103.0, 112.2,  98.0,  99.3, 126.3, 116.6, 104.5, 108.3, 103.5, 119.5, 109.0, 135.3, 155.0,  89.9, 108.1, 132.0,  87.1, 123.0,  87.7, 108.7,  88.9,  97.6,  86.6,  90.9, 105.4, 100.0,  95.4,  93.6,  94.1, 103.5,  99.4, 118.5, 148.0,  78.8), 
                   "glucagonAUC" = c( 5032.50, 12142.50, 10321.35,  6693.00,  7090.50, 10386.00, 10258.80, 16797.75,  2500.50, 11862.00,  5199.00,  5146.50,  3642.00,  4372.95,  5410.50,  7015.50,  6673.50,  5485.50,  6879.00, 14299.50,  4942.50, 14083.50,  6202.50,  6631.50, NA,  7609.50,  8424.60, 16300.50,  2376.00,  8212.50,  5502.00,  5217.00,  5911.50,  4520.10,  7833.00,  5497.50,  4857.00,  5010.00,  7953.00,  8739.00, 20421.00, 10945.50, 20121.00, 13090.50, 19155.00, 11778.00, 29979.75, 11040.00, 13657.50, 22875.00,  7906.50, 12897.00, 26555.10, 12903.90, NA, 16290.00, 17560.50, 16269.00, 12036.00, 26638.50,  9249.45,  7612.50, 17704.50,  4551.00, 12345.00,  8014.80, 11837.70,  6163.50, 11286.00, 12339.00,  6543.00, 11499.00, 23245.50, 12536.10, 18148.50, 10536.00,  8434.95,  7441.50, 10362.00, 11410.50), 
                   "time" = c("-3 month", "-3 month", "-3 month", "-3 month", "-3 month", "-3 month", "-3 month", "-3 month", "-3 month", "-3 month", "-3 month", "-3 month", "-3 month", "-3 month", "-3 month", "-3 month", "-3 month", "-3 month", "-3 month", "-3 month", "-1 week", "-1 week", "-1 week", "-1 week", "-1 week", "-1 week", "-1 week", "-1 week", "-1 week", "-1 week", "-1 week", "-1 week", "-1 week", "-1 week", "-1 week", "-1 week", "-1 week", "-1 week", "-1 week", "-1 week", "+1 week", "+1 week", "+1 week", "+1 week", "+1 week", "+1 week", "+1 week", "+1 week", "+1 week", "+1 week", "+1 week", "+1 week", "+1 week", "+1 week", "+1 week", "+1 week", "+1 week", "+1 week", "+1 week", "+1 week", "+3 month", "+3 month", "+3 month", "+3 month", "+3 month", "+3 month", "+3 month", "+3 month", "+3 month", "+3 month", "+3 month", "+3 month", "+3 month", "+3 month", "+3 month", "+3 month", "+3 month", "+3 month", "+3 month", "+3 month"), 
                   "time2" = c("-3 month", "-3 month", "-3 month", "-3 month", "-3 month", "-3 month", "-3 month", "-3 month", "-3 month", "-3 month", "-3 month", "-3 month", "-3 month", "-3 month", "-3 month", "-3 month", "-3 month", "-3 month", "-3 month", "-3 month", "-1 week", "-1 week", "-1 week", "-1 week", "-1 week", "-1 week", "-1 week", "-1 week", "-1 week", "-1 week", "-1 week", "-1 week", "-1 week", "-1 week", "-1 week", "-1 week", "-1 week", "-1 week", "-1 week", "-1 week", "+1 week", "+1 week", "+1 week", "+1 week", "+1 week", "+1 week", "+1 week", "+1 week", "+1 week", "+1 week", "+1 week", "+1 week", "+1 week", "+1 week", "+1 week", "+1 week", "+1 week", "+1 week", "+1 week", "+1 week", "+3 month", "+3 month", "+3 month", "+3 month", "+3 month", "+3 month", "+3 month", "+3 month", "+3 month", "+3 month", "+3 month", "+3 month", "+3 month", "+3 month", "+3 month", "+3 month", "+3 month", "+3 month", "+3 month", "+3 month"))

## long$time3 <- as.factor(as.numeric(long$time))
fit.time <- gls(weight~time3,
                data=long,
                correlation=corSymm(form=~visit|id),
                weights=varIdent(form=~1|time),
                na.action=na.exclude,
                control=glsControl(opt="optim"))
summary2(fit.time)

######################################################################
### test-previousBug.R ends here
